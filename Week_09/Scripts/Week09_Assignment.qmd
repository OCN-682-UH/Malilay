---
title: "Week 9 Assignment"
format: html
toc: true
author: "Ally Malilay"
date: "2025-10-28"
theme: united
mainfont: "Arial, sans-serif"
---
# Introduction
Let's take a closer look at the *Intertidal dataset*! This dataset records the organisms and benthic cover found in 10 transects at 15 unique sites in a quadrat located at low, medium, or high tide. We're going to to explore this dataset to answer the following question: **What is the average benthic cover type across all sites based on tide height?**


# Set Up Libraries
```{r}
#| message: false
#| warning: false

library(tidyverse)
library(here)
library(janitor)
library(ggthemes)
```

# Load data & clean
```{r}
#| message: false
#| warning: false
#Intertidal data
intertidal <- read_csv(here("Week_09","Data","intertidaldata.csv"))

#Data on the latitude of each site
latitude <- read_csv(here("Week_09", "Data", "intertidaldata_latitude.csv"))

#----------------CLEAN DATA---------------------#
#Check that there are no duplicate records using functions from janitor
get_dupes(intertidal, Transect, Quadrat, Site)

intertidal_clean <- intertidal %>%
  clean_names() %>% #clean column names
  mutate(quadrat = str_replace(quadrat, "\\.", ""), #remove the random . in Scripps quadrat data
         quadrat = str_replace(quadrat, "\\ 1", ""), #remove random 1 in Scripps quadrat data
         quadrat = str_trim(quadrat), #remove white spaces from both sides
         tide = factor(quadrat, levels = c("Low", "Mid", "High")), #make new tide column and convert to factor
         invertebrate_cover = rowMeans(select(., mussels, small_barnacles, large_barnacles, gooseneck_barnacles, anemone))) %>% #calculate the mean invertebrate cover
  select(-mussels, -small_barnacles, -large_barnacles, -gooseneck_barnacles, -anemone, -quadrat, - whelks_counts, -crabs_counts, -stars_counts) %>% #remove unnecessary columns
   group_by(site, tide) %>%
  summarise(bare_rock = mean(bare_rock), #calculate the total means based on site and tide
         algae = mean(algae),
         invertebrate_cover = mean(invertebrate_cover)) %>%
  pivot_longer(cols = c(bare_rock, algae, invertebrate_cover), #pivot the total means to plot
               names_to = "benthic_cover",
               values_to = "percent_cover") %>%
 mutate(benthic_cover = recode(benthic_cover, #rename for clear legend
                               "bare_rock" = "Rock",
                               "algae" = "Algae",
                               "invertebrate_cover" = "Invertebrate"))
```

# Our Plot!
```{r}
#| message: false
#| warning: false
plot <- ggplot(intertidal_clean,
               aes(x = tide,
                   y = percent_cover,
                   fill = benthic_cover)) +
                 geom_col() + 
                 facet_wrap(~site) +
  labs(title = "Average Benthic Cover Type across Sites",   
       fill = "Benthic Cover Type", 
       x = "Tide",
       y= "Average Cover (%)") +
  theme_bw() + #change theme 
  theme(axis.title = element_text(face = "plain"), #adjust axis and legend titles to plain
        legend.title = element_text(face = "plain"), 
        title = element_text(size = 14, face = "bold"))
 plot
 ggsave(here("Week_09","Output","Week09_Assignment.png"))
```

